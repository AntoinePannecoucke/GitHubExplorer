  name: Workflow - Feature
  on:
    push:
      branches:
        - 'feature/*'
  jobs:
    build_apk:
      runs-on: ubuntu-20.04
      steps:
        - uses: actions/checkout@v3
        - run: chmod +x gradlew
        - run: |
            KEYSTORE_P12_ASC_FILE="keystore.asc"
            echo "${{ secrets.KEYSTORE_P12 }}">> ${KEYSTORE_P12_ASC_FILE}
            gpg -d \
              --batch \
              --passphrase "$(echo "${{ secrets.PASSWORD }}" | base64 --decode)" \
            "${KEYSTORE_P12_ASC_FILE}"> "keystore.p12"
        - run: |
            KEYSTORE_PROPERTIES_ASC_FILE="keystore_properties.asc"
            echo "${{ secrets.KEYSTORE_PROPERTIES }}">> ${KEYSTORE_PROPERTIES_ASC_FILE}
            gpg -d \
            --batch \
            --passphrase "$(echo "${{ secrets.PASSWORD }}" | base64 --decode)" \
            "${KEYSTORE_PROPERTIES_ASC_FILE}"> "keystore.properties"
        - run: ./gradlew -Pversion.buildNumber="${GITHUB_RUN_NUMBER}" assembleDevelopmentRelease
        - uses: actions/upload-artifact@v3
          with:
            name: demo-release-apk
            path: app/build/outputs/apk/development/release/app-development-release.apk
        - uses: rtCamp/action-slack-notify@v2
          env:
            SLACK_CHANNEL: workflows
            SLACK_COLOR: ${{ job.status }} # or a specific color like 'good' or '#ff00ff'
            SLACK_ICON: https://pngimg.com/uploads/github/github_PNG40.png
            SLACK_MESSAGE: "Workflow - Feature was launch :rocket:"
            SLACK_TITLE: "Workflow - Feature"
            SLACK_USERNAME: "Antoine GitHub Action"
            SLACK_WEBHOOK: "https://lp-iem-2021.slack.com"

